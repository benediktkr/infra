---
- name: install packages
  apt:
    name:
      - postfix
      - mailutils
    state: latest
    update_cache: yes
  tags:
    - packages

- set_fact:
    docker_cidr_mask: "{{ ip | ipaddr('prefix') }}"
  vars:
    ip: "{{ ansible_docker0.ipv4.network }}/{{ ansible_docker0.ipv4.netmask }}"
  when: ansible_docker0 is defined


- name: tempalate config
  template:
    src: main.cf.j2
    dest: /etc/postfix/main.cf
  notify: restart postfix
