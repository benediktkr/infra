---

- name: include temper stuff
  import_tasks: temper.yml
  tags: temper
  when: temper_enabled == True


- name: create directory for logs
  file:
   path: /srv/log
   state: directory
   mode: '0777'
   owner: root
   group: root

- name: copy config
  copy:
    src: private/sudoisbot.yml
    dest: /etc/sudoisbot.yml
  tags:
    - checkclients
    - vpnserver
  when: False


# - name: temp task to uninstall first
#   pip:
#     name: sudoisbot
#     state: absent
#     executable: "{{ item }}"
#   with_items:
#     - pip
#     - pip3
#   when: inventory_hostname != "pi1.sudo.is"

# - name: packages for various bot scripts
#   apt:
#     name:
#       - mplayer
#     state: present
#   tags:
#     - packages

- name: pip3 upgrade
  pip:
    name: pip
    extra_args: --upgrade
    state: latest
    executable: pip3
  tags:
    - sudoisbot_install


# change state to 'latest' when thinngs are stable
- name: install from git
  pip:
    name: git+https://github.com/benediktkr/sudoisbot.git
    state: latest
    executable: pip3
  tags:
    - sudoisbot_install
